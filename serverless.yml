service: ${self:custom.service}
frameworkVersion: "3"

custom: ${file(config/serverless/common-custom-config.yaml)}

provider:
  name: aws
  runtime: nodejs20.x
  memorySize: 1024
  versionFunctions: false
  stage: ${opt:stage, self:custom.defaultStage}
  region: ${self:custom.regions.code.${opt:stage}}
  logRetentionInDays: 5
  deploymentPrefix: serverless
  environment:
    NASA_API_KEY: 'scwXDlZEdAAdcZ8JjYcdPXSzF9xUIi9UjQQnERyl'
    CACHE_TTL: 1800
    DYNAMO_TABLE_NAME: "FusionTable"
    IS_OFFLINE: true
    AWS_REGION: ${self:custom.regions.code.${opt:stage}}
  lambdaHashingVersion: 20201221
plugins:
  - serverless-esbuild
  - serverless-offline

functions: ${file(config/serverless/functions.${self:custom.functionsFile}.yml)}

resources: ${file(config/serverless/resources.yml)}